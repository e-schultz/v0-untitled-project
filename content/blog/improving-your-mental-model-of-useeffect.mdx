---
title: Improving Your Mental Model Of Useeffect
date: '2025-04-18'
description: >-
  Hooks landed in React a few months ago, and there has been a lot of excitement
  around them in terms of figuring out how to best use them, best practices, and
  how they map to current concepts in React and the lifecycle.
tags:
  - uncategorized
image: null
url: 'https://rangle.io/blog/improving-your-mental-model-of-useeffect'
slug: improving-your-mental-model-of-useeffect
---

<div class="css-udzbms"><div class="css-7i1khu"><section class="css-r3fqbs"><p class="css-16cimln">Aug 20, 2019 — Read time: <strong>4 mins</strong></p><div class="css-wyhr2r"><div class="css-1uxw0xd"><div class="css-n3pbl1"><a href="/blog/author/evan-schultz"><span class="ds-figure"><figure class="css-14taefl"><img src="images/improving-your-mental-model-of-useeffect-evan.png" alt="" loading="lazy" sizes="(max-width: 360px) , 75px" class="css-7tbaik"></figure></span></a></div><div><a href="/blog/author/evan-schultz"><span class="css-1i82ydo">Evan Schultz</span></a><span class="css-1i82ydo">Technical Director</span></div></div></div><h1>Improving your mental model of useEffect</h1><div class="css-6u2tq1"><div color="red" class="css-1rekqu8">frontend</div><div color="grey" class="css-ro6flr">development</div></div><div class="css-jr2m3h"><p class="ds-large-body">Hooks landed in React a few months ago, and there has been a lot of excitement around them in terms of figuring out how to best use them, best practices, and how they map to current concepts in React and the lifecycle.</p></div><div class="css-11b6it4"><span class="ds-figure"><figure class="css-14taefl"><img src="images/improving-your-mental-model-of-useeffect-feature-photo.png" alt="gears holding a crane hook" loading="lazy" sizes="100%" class="css-4a0506"></figure></span></div><article><div class="css-1q29gwd"><p>Hooks landed in React a few months ago, and there has been a lot of excitement around them in terms of figuring out how to best use them, best practices, and how they map to current concepts in React and the lifecycle.</p><p>Many React developers are familiar with the React Component lifeCycle, and hooks like:</p><ul><li class=""><a href="https://reactjs.org/docs/react-component.html#componentdidmount" target="_blank" data-on="click" data-event-category="CTA" data-event-action="click" data-event-label="https://reactjs.org/docs/react-component.html#componentdidmount" style="text-decoration:underline" class="css-k1irjw"><span class="ds-link css-aplkc0">componentDidMount</span></a></li><li class=""><a href="https://reactjs.org/docs/react-component.html#componentdidupdate" target="_blank" data-on="click" data-event-category="CTA" data-event-action="click" data-event-label="https://reactjs.org/docs/react-component.html#componentdidupdate" style="text-decoration:underline" class="css-k1irjw"><span class="ds-link css-aplkc0">componentDidUpdate</span></a></li><li class=""><a href="https://reactjs.org/docs/react-component.html#shouldcomponentupdate" target="_blank" data-on="click" data-event-category="CTA" data-event-action="click" data-event-label="https://reactjs.org/docs/react-component.html#shouldcomponentupdate" style="text-decoration:underline" class="css-k1irjw"><span class="ds-link css-aplkc0">shouldComponentUpdate</span></a></li><li class="">Etc.</li></ul><p>When trying to understand the useEffect hook, it’s natural to want to map it to the lifecycle methods we already know. &nbsp;</p><p>At first glance, useEffect seems to be like a combination of componentDidMount and componentDidUpdate. While this can be a useful way of looking at it at first, it may not be the most accurate. Instead of thinking in terms of 'what do I want to do when I mount, or when I update', its more useful to ask:</p><div class="css-5u8i8j"><div class="css-1q29gwd"><p><em>What values does this effect depend on?</em></p></div></div><p>To better understand where the the mental mapping of useEffect = componentDidMount + componentDidUpdate comes from, we will first look at a typical class based component that is doing some data fetching.</p><pre style="display:block;overflow-x:auto;background:#fefefe;color:#545454;padding:0.5em"><code class="language-javascript" style="white-space:pre"><span>
</span><span></span><span style="color:#7928a1">export</span><span> </span><span style="color:#7928a1">default</span><span> SearchComponent </span><span style="color:#7928a1">extends</span><span> Component {
</span><span>  </span><span class="hljs-function" style="color:#007faa">constructor</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#aa5d00">props</span><span class="hljs-function">)</span><span> {
</span><span>    </span><span style="color:#aa5d00">super</span><span>(props);
</span><span>    </span><span style="color:#aa5d00">this</span><span>.state = {
</span><span>      </span><span class="hljs-attr">results</span><span>: []
</span>    }
<!-- -->  }
<span>  </span><span class="hljs-function" style="color:#007faa">componentDidMount</span><span class="hljs-function">(</span><span class="hljs-function">)</span><span> {
</span><span>    </span><span style="color:#aa5d00">this</span><span>.query(</span><span style="color:#aa5d00">this</span><span>.props.id)
</span>  }
<span>  </span><span class="hljs-function" style="color:#007faa">componentDidUpdate</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#aa5d00">prevProps</span><span class="hljs-function">)</span><span> {
</span><span>    </span><span style="color:#7928a1">if</span><span>(</span><span style="color:#aa5d00">this</span><span>.prevProps.id !== </span><span style="color:#aa5d00">this</span><span>.props.id) {
</span><span>      </span><span style="color:#aa5d00">this</span><span>.query(</span><span style="color:#aa5d00">this</span><span>.props.id);
</span>    }
<!-- -->  }
<span>  </span><span class="hljs-function" style="color:#007faa">query</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#aa5d00">id</span><span class="hljs-function">)</span><span> {
</span><span>    </span><span style="color:#aa5d00">this</span><span>.setState({</span><span class="hljs-attr">isLoading</span><span>: </span><span style="color:#aa5d00">true</span><span>})
</span><span>    fetch(</span><span style="color:#008000">`/some/url/</span><span class="hljs-subst" style="color:#008000">${id}</span><span style="color:#008000">`</span><span>)
</span><span>      .then(</span><span class="hljs-function" style="color:#aa5d00">r</span><span class="hljs-function">=&gt;</span><span>r.json())
</span><span>      .then(</span><span class="hljs-function" style="color:#aa5d00">r</span><span class="hljs-function">=&gt;</span><span style="color:#aa5d00">this</span><span>.setState({
</span><span>        </span><span class="hljs-attr">results</span><span>: results
</span>      });
<!-- -->    )
<!-- -->  }
<!-- -->}</code></pre><p>When the component first mounts, we fetch data for the id that has been passed down as a prop. When the component updates, since many things other than just the id prop changing can cause this method to run, we want to ensure that id has actually changed - or some poor server is going to get a DDoS attack with a bunch of API calls that we don't need.</p><p>While the lifecycle hooks of componentDidMount and componentDidUpdate with class based components are common places to make a request based on a property, the fact that the component is mounting or updating is not really the thing we are concerned with.</p><p>What we <em>are</em> concerned with: <em>"what data does the query depend on?</em>”</p><p>Before looking at how to handle this with useEffect, lets quickly review the API of useEffect:</p><ul><li class="">Accepts a function</li><li class="">If it returns a function, it will do cleanup when the component is unmounted</li><li class="">Has an optional 2nd argument to pass in the data it depends on</li></ul><p>One of the key things to keep in mind is the importance of that second argument, the <a href="https://reactjs.org/docs/hooks-effect.html" target="_blank" data-on="click" data-event-category="CTA" data-event-action="click" data-event-label="https://reactjs.org/docs/hooks-effect.html" style="text-decoration:underline" class="css-k1irjw"><span class="ds-link css-aplkc0">React Docs </span></a>go into this in detail, but a summary is:</p><ul><li class="">If we leave it blank - it will run on every single render.</li><li class="">If we pass in an empty array - it will execute only when the component mounts, and not on any updates</li><li class="">If we pass in a value - it will execute when any of those values change</li><li class="">If you are using the react-hooks eslint plugin (and you should) - not providing the dependencies to your useEffect will give you warnings.</li></ul><pre style="display:block;overflow-x:auto;background:#fefefe;color:#545454;padding:0.5em"><code class="language-javascript" style="white-space:pre"><span style="color:#7928a1">export</span><span> </span><span style="color:#7928a1">default</span><span> SomeComponent = </span><span class="hljs-function">(</span><span class="hljs-function" style="color:#aa5d00">{id}</span><span class="hljs-function">) =&gt;</span><span> {
</span><span>  </span><span style="color:#7928a1">let</span><span> [results, setResults] = useState([]);
</span><span>  useEffect(</span><span class="hljs-function">()=&gt;</span><span>{
</span><span>    fetch(</span><span style="color:#008000">`/some/url/</span><span class="hljs-subst" style="color:#008000">${id}</span><span style="color:#008000">`</span><span>)
</span><span>      .then(</span><span class="hljs-function" style="color:#aa5d00">r</span><span class="hljs-function">=&gt;</span><span>r.json())
</span><span>      .then(</span><span class="hljs-function" style="color:#aa5d00">r</span><span class="hljs-function">=&gt;</span><span>setResults(r))
</span>  },[id])
<!-- -->}</code></pre><p>In the class based version, making API calls feels very imperative - when this method is called, I want to check if/how a value has changed, and if it has changed - I want to call a method.</p><p>If the component is being created or updated often isn’t the thing the matters. What we <em>actually</em> care about is “has the values that I care about changed?”. Before hooks were introduced, componentDidMount and componentDidUpdate were the best tools for the job at the time.</p><p>With the hook based version, we are able to express this intent in a more declarative way: "<em>I want to fetch data when the id changes</em>"</p><h3 id="how-do-we-identify-what-the-effect-depends-on?">How do we identify what the effect depends on?</h3><p>The eslint plugin can guide you in the right direction, but the short version is, <em>"is there a variable that impacts how we run the effect?</em>" If so, add it to the dependencies.</p><p>To demonstrate this, lets add an extra query parameter to our search:</p><pre style="display:block;overflow-x:auto;background:#fefefe;color:#545454;padding:0.5em"><code class="language-javascript" style="white-space:pre"><span>
</span><span></span><span style="color:#7928a1">export</span><span> </span><span style="color:#7928a1">default</span><span> SomeComponent = </span><span class="hljs-function">(</span><span class="hljs-function" style="color:#aa5d00">{id, filter}</span><span class="hljs-function">) =&gt;</span><span> {
</span><span>  </span><span style="color:#7928a1">let</span><span> [results, setResults] = useState([]);
</span>
<span>  useEffect(</span><span class="hljs-function">()=&gt;</span><span>{
</span><span>    fetch(</span><span style="color:#008000">`/some/url/</span><span class="hljs-subst" style="color:#008000">${id}</span><span style="color:#008000">?filter=</span><span class="hljs-subst" style="color:#008000">${filter}</span><span style="color:#008000">`</span><span>)
</span><span>      .then(</span><span class="hljs-function" style="color:#aa5d00">r</span><span class="hljs-function">=&gt;</span><span>r.json())
</span><span>      .then(</span><span class="hljs-function" style="color:#aa5d00">r</span><span class="hljs-function">=&gt;</span><span>setResults(r))
</span>  },[id])
<!-- -->}</code></pre><p>Even though we have added filter to the fetch query string, we have not added it to the dependencies of useEffect. &nbsp;As we update the filter, we won't be calling the API on any of the other updates, and it will only run when the id has changed.</p><p>Fixing this is simple enough - just add the filter to the list of data dependencies for the useEffect.</p><pre style="display:block;overflow-x:auto;background:#fefefe;color:#545454;padding:0.5em"><code class="language-javascript" style="white-space:pre"><span style="color:#7928a1">export</span><span> </span><span style="color:#7928a1">default</span><span> SomeComponent = </span><span class="hljs-function">(</span><span class="hljs-function" style="color:#aa5d00">{id, filter}</span><span class="hljs-function">) =&gt;</span><span> {
</span><span>  </span><span style="color:#7928a1">let</span><span> [results, setResults] = useState([]);
</span>
<span>  useEffect(</span><span class="hljs-function">()=&gt;</span><span>{
</span><span>    fetch(</span><span style="color:#008000">`/some/url/</span><span class="hljs-subst" style="color:#008000">${id}</span><span style="color:#008000">?filter=</span><span class="hljs-subst" style="color:#008000">${filter}</span><span style="color:#008000">`</span><span>)
</span><span>      .then(</span><span class="hljs-function" style="color:#aa5d00">r</span><span class="hljs-function">=&gt;</span><span>r.json())
</span><span>      .then(</span><span class="hljs-function" style="color:#aa5d00">r</span><span class="hljs-function">=&gt;</span><span>setResults(r))
</span>  },[id, filter])
<!-- -->}</code></pre><p>As you can see, to properly use useEffect in this case, we don’t care if the component is mounting, or updating, or where it is in the life cycle - what we do care about is what data does this effect depend on.</p><p>useEffect is a very useful tool to add to our toolbox when working with React, but it can also be one of the more difficult hooks to fully understand. Hopefully this post can help clarify things a little bit better, but if you are curious for a deeper dive, be sure to check out Dan Abramovs’ post, <a href="https://overreacted.io/a-complete-guide-to-useeffect/" target="_blank" data-on="click" data-event-category="CTA" data-event-action="click" data-event-label="https://overreacted.io/a-complete-guide-to-useeffect/" style="text-decoration:underline" class="css-k1irjw"><span class="ds-link css-aplkc0">A Complete Guide to useEffect</span></a></p></div></article></section></div></div>
